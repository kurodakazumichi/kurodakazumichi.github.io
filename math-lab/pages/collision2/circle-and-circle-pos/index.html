<!DOCTYPE html>
<html>
  <head>
    <title>円と円の交点 | 無職の学び舎 </title>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-180265202-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-180265202-1');
    </script>

    <head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
    <meta property="og:type" content="article" />
    <meta property="og:title" content="円と円の交点" />
    <meta property="og:site_name" content="無職はゲーム数学の勉強をする | 無職の学び舎" />
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@ProgPuyan" />
    
    <script src="../../../assets/js/mathLab.js"></script>
    <link rel="stylesheet" href="../../../assets/css/default.css">

    
    <script src="../../../venders/somali/somali.js"></script>
    <script src="../../../venders/highlight/highlight.pack.js"></script>
    <link rel="stylesheet" href="../../../venders/highlight/atom-one-dark.css">

    <script>
      MathJax = {
        chtml: {
          matchFontHeight: false
        },
        tex: {
          inlineMath: [['$', '$']]
        }
      };
    </script>
    <script id="MathJax-script" async
      src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js">
    </script>    

    <script src="../../../assets/js/props.js"></script>
  </head>
  <body>
    <header>
      <ol itemscope itemtype="https://schema.org/BreadcrumbList">
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a itemprop="item" href="https://www.nekonecode.com">
            <span itemprop="name">無職の学び舎</span>
          </a>
          <meta itemprop="position" content="1" />
        </li>
        <li>&gt;</li>
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a itemprop="item" href="../../../index.html">
            <span itemprop="name">無職はゲーム数学の勉強をする</span>
          </a>
          <meta itemprop="position" content="2" />
        </li>
        <li>&gt;</li>
        <li>円と円の交点</li>
      </ol>      
    </header>
    <main>
      <article>
        <h1>円と円の交点</h1>
        <div id="graph1"></div>

<p>
  <a href="../circle-and-circle/">円と円の衝突</a>は非常にシンプルで簡単なのですが、円と円の交点を求めようとすると突如難易度が上がります。
</p>

<p>
  ここではそんな円と円の交点の求め方についてまとめていきます。
</p>

<h2>円と円の交点の考え方</h2>

<p>2つの円があります。</p>

<p>円の中心をそれぞれ$C_{1}, C_{2}$、円の交点をそれぞれ $P, P'$ とします。</p>

<p>線分 $C_{1}C_{2}$ と 線分 ${PP'}$ の交点を $H$ とします。</p>
<p>この時、$\angle C_{1}HP$ は<b>90度</b>になります。</p>

<p>$C_{1}$ から $C_{2}$ に向かうベクトル $\vec{C_{1}C_{2}}$ を<b>正規化</b>したベクトルを $\vec{n_{1}}$ とします。</p>

<p>$\vec{n_{1}}$ を 左に<b>90度回転</b>させたベクトル ($H$ から $P$ に向かう)を $\vec{n_{2}}$ とします。</p>

<p>交点 $P$ の位置は、$C_{1}$ に $\vec{n_{1}}$ を伸ばしたベクトルを足して $H$ まで行き</p>

<p>さらに $H$ から $\vec{n_{2}}$ を伸ばしたベクトルを足すことでたどり着くことができます。</p>

<p>$P'$ にたどり着くには、$H$ から $\vec{n_{2}}$ を逆方向に伸ばせばたどりつけます。</p>

<p>様々な計算が必要になりますが、これが円と円の交点を求める大まかな流れとなります。</p>

<h2>円と円の交点の求め方</h2>

<p>円の中心をそれぞれ$C_{1}, C_{2}$、円の半径をそれぞれ $r_{1}, r_{2}$、円の交点をそれぞれ $P, P'$、線分$C_{1}C_{2}$ と 線分 $PP'$ の交点を $H$とします。</p>

<h3>辺$C_{1}H$ の長さを求める編</h3>
<p>まず辺$C_{1}H$ の長さを求めることから始めます。</p>
<p>ひとまず、$\triangle C_{1}C_{2}P$ の各辺 $C_{1}C_{2}, C_{1}P, C_{2}P$ の長さをそれぞれ、$a, b, c$ とおきます。</p>

<p>この時、三角形の三辺 $a, b, c$ の長さは全てわかっているという事実があります。</p>

<p class="math">
  $a = |\vec{C_{1}C_{2}}|$<br>
  $b = r_{1}$<br>
  $c = r_{2}$<br>
</p>

<p>三角形には素敵な性質が沢山ありますが、<b>3辺全ての長さが分かっていると余弦定理</b>が使えます。</p>

<p>とりあえず、$\angle PC_{1}C_{2}$ の角度を $\theta$ とおき、$cos(\theta)$ の値を求めてみたいと思います。</p>

<p>$cos(\theta)$ は<b>余弦定理</b>より、以下の計算で求める事ができます。</p>

<p class="math">
  $cos(\theta) = \frac{a^2 + b^2 - c^2}{2ab}$
</p>

<p>するとなんと、$cos(\theta)$ を求めた事によって、辺 $C_{1}H$ の長さを求めることができるようになります。</p>

<p>辺 $C_{1}H$ の長さを $r_{c}$ とおいておきます。</p>

<p>$r_{c}$ は $b$ と $cos(\theta)$ の掛け算するだけで求める事ができてしまいます。</p>

<p class="math">
  $r_{c} = b \cdot cos(\theta)$
</p>

<p>なぜこれで、$r_{c}$ が求まるのかの補足</p>

<p class="math">
  $cos(\theta)$ は$\frac{底辺}{斜辺}$ なので、図から $\frac{r_{c}}{b}$ となります。<br>
  $b \cdot cos(\theta)$ は以下のように置き換えられます。<br>
  $b \cdot \frac{r_{c}}{b} = r_{c}$
</p>

<p>長い計算でしたが、これで目的だった 辺 $C_{1}H$ の長さが求まりました。</p>

<h3>辺 $HP$ の長さを求める編</h3>

<p>続いて求めたいのが、辺 $HP$ の長さとなります。</p>

<p>辺 $HP$ の長さを $r_{s}$ とおきます。</p>

<p>$\triangle PC_{1}H$ に注目すると、$\triangle PC_{1}H$ は直角三角形であり、2辺の長さはもうわかっています。</p>

<p>そして直角三角形の2辺の長さがわかっている時、<a href="../../theorem/pythagorean/">三平方の定理</a>を使って残りの辺の長さを求める事ができます。</p>

<p>
  直角三角形の底辺を $r_{c}$、斜辺は円の半径なので $r_{1}$ とすると、<a href="../../theorem/pythagorean/">三平方の定理</a>により
</p>

<p class="math">
  $r_{s} = \sqrt{r_{1}^2 - r_{c}^2}$
</p>

<p>これで$r_{s}$ が求まりました。</p>

<h3>$\vec{n_{1}}$と$\vec{n_{2}}$ を求める編</h3>

<h2>交点を持たないとき</h2>

<p>
  2つの円が交点を持たないケースが２パターンあります。
</p>

<p>１つは円が接触していないとき、もう一つは一方の円の中に円が内包されている時です。</p>

<p>それぞれについて判定方法を見ていきます。</p>

<h3>接触していない場合</h3>

<p>円と円が接触しているかどうかは、<a href="../circle-and-circle/">円と円の衝突</a>に方法を記載していますのでそちらをご覧ください。</p>

<h3>内包している場合</h3>

<p>
  円が一方の円の中に内包されているかどうかは、2つの円の距離と半径の差を比較します。(差はマイナスになることがあるので絶対値で比較します)
</p>

<p class="math">
  <b>円の距離 &lt; 半径の差の絶対値</b> であれば、円は内包関係にある。
</p>

<h3>プログラム的な話</h3>
<p>
  プログラムでは、円の交点を求める前に、接触しているかどうか、内包しているかどうかを調べます。
</p>

<p>接触していない、もしくは円が内包関係にある場合、交点は存在しないのでそこで処理を終えます。</p>

<h2>交点が１つのとき</h2>

<h3>外接しているケース</h3>

<h3>内接しているケース</h3>

<h2>サンプルコード</h2>
      </article>
    </main>

    <footer>
      <span>無職の学び舎 | Nekonecode</span>
    </footer>
    
    <script src="main.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>